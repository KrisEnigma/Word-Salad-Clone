var it=Object.defineProperty;var _e=c=>{throw TypeError(c)};var nt=(c,e,t)=>e in c?it(c,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):c[e]=t;var ve=(c,e,t)=>nt(c,typeof e!="symbol"?e+"":e,t),Fe=(c,e,t)=>e.has(c)||_e("Cannot "+t);var R=(c,e,t)=>(Fe(c,e,"read from private field"),t?t.call(c):e.get(c)),he=(c,e,t)=>e.has(c)?_e("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(c):e.set(c,t),G=(c,e,t,i)=>(Fe(c,e,"write to private field"),i?i.call(c,t):e.set(c,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();/*! Capacitor: https://capacitorjs.com/ - MIT License */var pe;(function(c){c.Unimplemented="UNIMPLEMENTED",c.Unavailable="UNAVAILABLE"})(pe||(pe={}));class Pe extends Error{constructor(e,t,i){super(e),this.message=e,this.code=t,this.data=i}}const rt=c=>{var e,t;return c!=null&&c.androidBridge?"android":!((t=(e=c==null?void 0:c.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||t===void 0)&&t.bridge?"ios":"web"},st=c=>{const e=c.CapacitorCustomPlatform||null,t=c.Capacitor||{},i=t.Plugins=t.Plugins||{},r=()=>e!==null?e.name:rt(c),s=()=>r()!=="web",a=p=>{const b=u.get(p);return!!(b!=null&&b.platforms.has(r())||l(p))},l=p=>{var b;return(b=t.PluginHeaders)===null||b===void 0?void 0:b.find(C=>C.name===p)},d=p=>c.console.error(p),u=new Map,E=(p,b={})=>{const C=u.get(p);if(C)return console.warn(`Capacitor plugin "${p}" already registered. Cannot register plugins twice.`),C.proxy;const N=r(),D=l(p);let S;const O=async()=>(!S&&N in b?S=typeof b[N]=="function"?S=await b[N]():S=b[N]:e!==null&&!S&&"web"in b&&(S=typeof b.web=="function"?S=await b.web():S=b.web),S),j=(x,k)=>{var F,q;if(D){const J=D==null?void 0:D.methods.find(U=>k===U.name);if(J)return J.rtype==="promise"?U=>t.nativePromise(p,k.toString(),U):(U,oe)=>t.nativeCallback(p,k.toString(),U,oe);if(x)return(F=x[k])===null||F===void 0?void 0:F.bind(x)}else{if(x)return(q=x[k])===null||q===void 0?void 0:q.bind(x);throw new Pe(`"${p}" plugin is not implemented on ${N}`,pe.Unimplemented)}},B=x=>{let k;const F=(...q)=>{const J=O().then(U=>{const oe=j(U,x);if(oe){const ae=oe(...q);return k=ae==null?void 0:ae.remove,ae}else throw new Pe(`"${p}.${x}()" is not implemented on ${N}`,pe.Unimplemented)});return x==="addListener"&&(J.remove=async()=>k()),J};return F.toString=()=>`${x.toString()}() { [capacitor code] }`,Object.defineProperty(F,"name",{value:x,writable:!1,configurable:!1}),F},Q=B("addListener"),ee=B("removeListener"),se=(x,k)=>{const F=Q({eventName:x},k),q=async()=>{const U=await F;ee({eventName:x,callbackId:U},k)},J=new Promise(U=>F.then(()=>U({remove:q})));return J.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await q()},J},te=new Proxy({},{get(x,k){switch(k){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return D?se:Q;case"removeListener":return ee;default:return B(k)}}});return i[p]=te,u.set(p,{name:p,proxy:te,platforms:new Set([...Object.keys(b),...D?[N]:[]])}),te};return t.convertFileSrc||(t.convertFileSrc=p=>p),t.getPlatform=r,t.handleError=d,t.isNativePlatform=s,t.isPluginAvailable=a,t.registerPlugin=E,t.Exception=Pe,t.DEBUG=!!t.DEBUG,t.isLoggingEnabled=!!t.isLoggingEnabled,t},at=c=>c.Capacitor=st(c),W=at(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),ue=W.registerPlugin;class qe{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,t){let i=!1;this.listeners[e]||(this.listeners[e]=[],i=!0),this.listeners[e].push(t);const s=this.windowListeners[e];s&&!s.registered&&this.addWindowListener(s),i&&this.sendRetainedArgumentsForEvent(e);const a=async()=>this.removeListener(e,t);return Promise.resolve({remove:a})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,t,i){const r=this.listeners[e];if(!r){if(i){let s=this.retainedEventArguments[e];s||(s=[]),s.push(t),this.retainedEventArguments[e]=s}return}r.forEach(s=>s(t))}hasListeners(e){return!!this.listeners[e].length}registerWindowListener(e,t){this.windowListeners[t]={registered:!1,windowEventName:e,pluginEventName:t,handler:i=>{this.notifyListeners(t,i)}}}unimplemented(e="not implemented"){return new W.Exception(e,pe.Unimplemented)}unavailable(e="not available"){return new W.Exception(e,pe.Unavailable)}async removeListener(e,t){const i=this.listeners[e];if(!i)return;const r=i.indexOf(t);this.listeners[e].splice(r,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const t=this.retainedEventArguments[e];t&&(delete this.retainedEventArguments[e],t.forEach(i=>{this.notifyListeners(e,i)}))}}const Re=c=>encodeURIComponent(c).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),ze=c=>c.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class ot extends qe{async getCookies(){const e=document.cookie,t={};return e.split(";").forEach(i=>{if(i.length<=0)return;let[r,s]=i.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");r=ze(r).trim(),s=ze(s).trim(),t[r]=s}),t}async setCookie(e){try{const t=Re(e.key),i=Re(e.value),r=`; expires=${(e.expires||"").replace("expires=","")}`,s=(e.path||"/").replace("path=",""),a=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${t}=${i||""}${r}; path=${s}; ${a};`}catch(t){return Promise.reject(t)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(t){return Promise.reject(t)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const t of e)document.cookie=t.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}ue("CapacitorCookies",{web:()=>new ot});const ct=async c=>new Promise((e,t)=>{const i=new FileReader;i.onload=()=>{const r=i.result;e(r.indexOf(",")>=0?r.split(",")[1]:r)},i.onerror=r=>t(r),i.readAsDataURL(c)}),lt=(c={})=>{const e=Object.keys(c);return Object.keys(c).map(r=>r.toLocaleLowerCase()).reduce((r,s,a)=>(r[s]=c[e[a]],r),{})},dt=(c,e=!0)=>c?Object.entries(c).reduce((i,r)=>{const[s,a]=r;let l,d;return Array.isArray(a)?(d="",a.forEach(u=>{l=e?encodeURIComponent(u):u,d+=`${s}=${l}&`}),d.slice(0,-1)):(l=e?encodeURIComponent(a):a,d=`${s}=${l}`),`${i}&${d}`},"").substr(1):null,ut=(c,e={})=>{const t=Object.assign({method:c.method||"GET",headers:c.headers},e),r=lt(c.headers)["content-type"]||"";if(typeof c.data=="string")t.body=c.data;else if(r.includes("application/x-www-form-urlencoded")){const s=new URLSearchParams;for(const[a,l]of Object.entries(c.data||{}))s.set(a,l);t.body=s.toString()}else if(r.includes("multipart/form-data")||c.data instanceof FormData){const s=new FormData;if(c.data instanceof FormData)c.data.forEach((l,d)=>{s.append(d,l)});else for(const l of Object.keys(c.data))s.append(l,c.data[l]);t.body=s;const a=new Headers(t.headers);a.delete("content-type"),t.headers=a}else(r.includes("application/json")||typeof c.data=="object")&&(t.body=JSON.stringify(c.data));return t};class ht extends qe{async request(e){const t=ut(e,e.webFetchExtra),i=dt(e.params,e.shouldEncodeUrlParams),r=i?`${e.url}?${i}`:e.url,s=await fetch(r,t),a=s.headers.get("content-type")||"";let{responseType:l="text"}=s.ok?e:{};a.includes("application/json")&&(l="json");let d,u;switch(l){case"arraybuffer":case"blob":u=await s.blob(),d=await ct(u);break;case"json":d=await s.json();break;case"document":case"text":default:d=await s.text()}const E={};return s.headers.forEach((p,b)=>{E[b]=p}),{data:d,headers:E,status:s.status,url:s.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}ue("CapacitorHttp",{web:()=>new ht});const mt=[{id:"vg_characters",name:"VG Characters",data:{SONIC:"a1b1c1d1c2","LARA CROFT":"a3b3c4d3c2d2c3b2a2",MARIO:"d4d3c4b4a4"}},{id:"chess",name:"Ajedrez",data:{PAWN:"a1a2a3b3",QUEEN:"d4c4b4a4b3",KING:"c3c2b3b2",KNIGHT:"c3b3c2b2c1d1",BISHOP:"d3c2d2c1b1a1"}},{id:"planets",name:"Planetas",data:{MARS:"c4b3c3b4",MERCURY:"c4d4c3d2c2d1c1",NEPTUNE:"a3a2b1b2c2d3d4",SATURN:"b4b3b2c2c3d3",URANUS:"c2c3b3a3a4b4",VENUS:"a1a2a3a4b4"}}],ne=mt.reduce((c,{id:e,name:t,data:i})=>(c[e]={name:t,data:i},c),{}),Y=Object.keys(ne);class ft{constructor(e,t,i){this.board=e,this.board.querySelectorAll("svg").forEach(r=>r.remove()),this.svgContainer=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.svgContainer.id="lines",this.board.insertBefore(this.svgContainer,this.board.firstChild),this.onSelectionUpdate=i,this.selected=[],this._isPointerDown=!1,this._isDragging=!1,this.potentialUndo=null,this.startedInsideBoard=!1,this._lastTouchMove=null,this._lastTouchEvent=null,this._wasSelecting=!1}reset(){this.selected.forEach(e=>document.getElementById(`mark-${e}`).classList.remove("selected")),this.svgContainer.innerHTML="",this.selected=[],this.potentialUndo=null}resetControls(){[this._isPointerDown,this._isDragging,this.potentialUndo,this.startedInsideBoard]=[!1,!1,null,!1]}getCurrentSelection(){return[...this.selected]}drawLine(){this.svgContainer.innerHTML="",this.selected.forEach((e,t)=>{if(t===0)return;const i=document.createElementNS("http://www.w3.org/2000/svg","line"),[r,s]=[this.selected[t-1],e].map(l=>document.getElementById(`mark-${l}`).getBoundingClientRect()),a=this.board.getBoundingClientRect();["x1","y1","x2","y2"].forEach((l,d)=>{const u=d<2?r:s;i.setAttribute(l,u[l.startsWith("x")?"x":"y"]+u.width/2-a[l.startsWith("x")?"x":"y"])}),this.svgContainer.appendChild(i)})}handleLetterSelection(e){const t=this.selected.length;if(this.selected.includes(e))return e===this.selected[t-1]?(this.potentialUndo=e,this.onSelectionUpdate(this.selected),!0):e===this.selected[t-2]?(document.getElementById(`mark-${this.selected[t-1]}`).classList.remove("selected"),this.selected.pop(),this.drawLine(),this.onSelectionUpdate(this.selected),!0):!1;if(this.potentialUndo=null,!t||this.areAdjacent(this.selected[t-1],e)){const i=document.getElementById(`mark-${e}`);return this.selected.push(e),i.classList.add("selected"),this.drawLine(),this.onSelectionUpdate(this.selected),!0}return this.isDragging?!1:(this.reset(),document.getElementById(`mark-${e}`).classList.add("selected"),this.selected.push(e),this.onSelectionUpdate(this.selected),!0)}areAdjacent(e,t){if(e===t)return!1;const[i,r]=[e.charCodeAt(0)-97,parseInt(e[1])-1],[s,a]=[t.charCodeAt(0)-97,parseInt(t[1])-1];return Math.abs(i-s)<=1&&Math.abs(r-a)<=1}handlePointerDown(e){var r;const t=!!((r=e==null?void 0:e.target)!=null&&r.closest(".board"));if(this.startedInsideBoard=t,!t)return;const i=this.getHitboxFromEvent(e);if(!i){this.isDragging||this.reset();return}e.preventDefault(),this._isPointerDown=!0,this._isDragging=!1,this.handleLetterSelection(i.dataset.position)}handlePointerMove(e){var r;if(!this._isPointerDown||!((r=e.target)!=null&&r.closest(".board"))||(e.preventDefault(),!this.startedInsideBoard&&!this._isDragging))return;const t=this.getHitboxFromEvent(e);if(!t)return;const i=t.dataset.position;this.selected[this.selected.length-1]!==i&&(this._isDragging=!0,this.handleLetterSelection(i))}handlePointerUp(e){var t;if(!this._isDragging&&this.potentialUndo){const i=this.getHitboxFromEvent(e);i&&this.potentialUndo===i.dataset.position&&(document.getElementById(`mark-${this.potentialUndo}`).classList.remove("selected"),this.selected.pop(),this.drawLine())}(t=e==null?void 0:e.target)!=null&&t.closest(".board")?(this._isPointerDown=!1,this._isDragging=!1):(this.resetControls(),this.reset())}handlePointerOut(){return this._isPointerDown=!1,this._isDragging||this.selected.length>0}handlePointerEnter(e){e.buttons>0&&(this.startedInsideBoard||this.selected.length>0)&&(this._isPointerDown=!0)}getHitboxFromEvent(e){var t,i,r;if(!e)return null;if(e.touches||e.changedTouches){const s=((t=e.touches)==null?void 0:t[0])||((i=e.changedTouches)==null?void 0:i[0]);if(!s)return null;const a=document.elementFromPoint(s.clientX,s.clientY);return a==null?void 0:a.closest(".hitbox")}return(r=e.target)==null?void 0:r.closest(".hitbox")}isPlayableArea(e){return e!=null&&e.target?e.target.closest(".hitbox")||e.target.closest(".board"):!1}get isDragging(){return this._isDragging}get isPointerDown(){return this._isPointerDown}handleTouchMove(e){e.preventDefault(),this.handlePointerMove(e)}getWasSelecting(){return this._wasSelecting}setWasSelecting(e){this._wasSelecting=e}}var Ie={};(function c(e,t,i,r){var s=!!(e.Worker&&e.Blob&&e.Promise&&e.OffscreenCanvas&&e.OffscreenCanvasRenderingContext2D&&e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype.transferControlToOffscreen&&e.URL&&e.URL.createObjectURL),a=typeof Path2D=="function"&&typeof DOMMatrix=="function",l=function(){if(!e.OffscreenCanvas)return!1;var o=new OffscreenCanvas(1,1),n=o.getContext("2d");n.fillRect(0,0,1,1);var h=o.transferToImageBitmap();try{n.createPattern(h,"no-repeat")}catch{return!1}return!0}();function d(){}function u(o){var n=t.exports.Promise,h=n!==void 0?n:e.Promise;return typeof h=="function"?new h(o):(o(d,d),null)}var E=function(o,n){return{transform:function(h){if(o)return h;if(n.has(h))return n.get(h);var f=new OffscreenCanvas(h.width,h.height),g=f.getContext("2d");return g.drawImage(h,0,0),n.set(h,f),f},clear:function(){n.clear()}}}(l,new Map),p=function(){var o=Math.floor(16.666666666666668),n,h,f={},g=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(n=function(v){var y=Math.random();return f[y]=requestAnimationFrame(function m(w){g===w||g+o-1<w?(g=w,delete f[y],v()):f[y]=requestAnimationFrame(m)}),y},h=function(v){f[v]&&cancelAnimationFrame(f[v])}):(n=function(v){return setTimeout(v,o)},h=function(v){return clearTimeout(v)}),{frame:n,cancel:h}}(),b=function(){var o,n,h={};function f(g){function v(y,m){g.postMessage({options:y||{},callback:m})}g.init=function(m){var w=m.transferControlToOffscreen();g.postMessage({canvas:w},[w])},g.fire=function(m,w,P){if(n)return v(m,null),n;var I=Math.random().toString(36).slice(2);return n=u(function(M){function A(_){_.data.callback===I&&(delete h[I],g.removeEventListener("message",A),n=null,E.clear(),P(),M())}g.addEventListener("message",A),v(m,I),h[I]=A.bind(null,{data:{callback:I}})}),n},g.reset=function(){g.postMessage({reset:!0});for(var m in h)h[m](),delete h[m]}}return function(){if(o)return o;if(!i&&s){var g=["var CONFETTI, SIZE = {}, module = {};","("+c.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{o=new Worker(URL.createObjectURL(new Blob([g])))}catch(v){return typeof console!==void 0&&typeof console.warn=="function"&&console.warn("🎊 Could not load worker",v),null}f(o)}return o}}(),C={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function N(o,n){return n?n(o):o}function D(o){return o!=null}function S(o,n,h){return N(o&&D(o[n])?o[n]:C[n],h)}function O(o){return o<0?0:Math.floor(o)}function j(o,n){return Math.floor(Math.random()*(n-o))+o}function B(o){return parseInt(o,16)}function Q(o){return o.map(ee)}function ee(o){var n=String(o).replace(/[^0-9a-f]/gi,"");return n.length<6&&(n=n[0]+n[0]+n[1]+n[1]+n[2]+n[2]),{r:B(n.substring(0,2)),g:B(n.substring(2,4)),b:B(n.substring(4,6))}}function se(o){var n=S(o,"origin",Object);return n.x=S(n,"x",Number),n.y=S(n,"y",Number),n}function te(o){o.width=document.documentElement.clientWidth,o.height=document.documentElement.clientHeight}function x(o){var n=o.getBoundingClientRect();o.width=n.width,o.height=n.height}function k(o){var n=document.createElement("canvas");return n.style.position="fixed",n.style.top="0px",n.style.left="0px",n.style.pointerEvents="none",n.style.zIndex=o,n}function F(o,n,h,f,g,v,y,m,w){o.save(),o.translate(n,h),o.rotate(v),o.scale(f,g),o.arc(0,0,1,y,m,w),o.restore()}function q(o){var n=o.angle*(Math.PI/180),h=o.spread*(Math.PI/180);return{x:o.x,y:o.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:o.startVelocity*.5+Math.random()*o.startVelocity,angle2D:-n+(.5*h-Math.random()*h),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:o.color,shape:o.shape,tick:0,totalTicks:o.ticks,decay:o.decay,drift:o.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:o.gravity*3,ovalScalar:.6,scalar:o.scalar,flat:o.flat}}function J(o,n){n.x+=Math.cos(n.angle2D)*n.velocity+n.drift,n.y+=Math.sin(n.angle2D)*n.velocity+n.gravity,n.velocity*=n.decay,n.flat?(n.wobble=0,n.wobbleX=n.x+10*n.scalar,n.wobbleY=n.y+10*n.scalar,n.tiltSin=0,n.tiltCos=0,n.random=1):(n.wobble+=n.wobbleSpeed,n.wobbleX=n.x+10*n.scalar*Math.cos(n.wobble),n.wobbleY=n.y+10*n.scalar*Math.sin(n.wobble),n.tiltAngle+=.1,n.tiltSin=Math.sin(n.tiltAngle),n.tiltCos=Math.cos(n.tiltAngle),n.random=Math.random()+2);var h=n.tick++/n.totalTicks,f=n.x+n.random*n.tiltCos,g=n.y+n.random*n.tiltSin,v=n.wobbleX+n.random*n.tiltCos,y=n.wobbleY+n.random*n.tiltSin;if(o.fillStyle="rgba("+n.color.r+", "+n.color.g+", "+n.color.b+", "+(1-h)+")",o.beginPath(),a&&n.shape.type==="path"&&typeof n.shape.path=="string"&&Array.isArray(n.shape.matrix))o.fill(He(n.shape.path,n.shape.matrix,n.x,n.y,Math.abs(v-f)*.1,Math.abs(y-g)*.1,Math.PI/10*n.wobble));else if(n.shape.type==="bitmap"){var m=Math.PI/10*n.wobble,w=Math.abs(v-f)*.1,P=Math.abs(y-g)*.1,I=n.shape.bitmap.width*n.scalar,M=n.shape.bitmap.height*n.scalar,A=new DOMMatrix([Math.cos(m)*w,Math.sin(m)*w,-Math.sin(m)*P,Math.cos(m)*P,n.x,n.y]);A.multiplySelf(new DOMMatrix(n.shape.matrix));var _=o.createPattern(E.transform(n.shape.bitmap),"no-repeat");_.setTransform(A),o.globalAlpha=1-h,o.fillStyle=_,o.fillRect(n.x-I/2,n.y-M/2,I,M),o.globalAlpha=1}else if(n.shape==="circle")o.ellipse?o.ellipse(n.x,n.y,Math.abs(v-f)*n.ovalScalar,Math.abs(y-g)*n.ovalScalar,Math.PI/10*n.wobble,0,2*Math.PI):F(o,n.x,n.y,Math.abs(v-f)*n.ovalScalar,Math.abs(y-g)*n.ovalScalar,Math.PI/10*n.wobble,0,2*Math.PI);else if(n.shape==="star")for(var L=Math.PI/2*3,$=4*n.scalar,H=8*n.scalar,V=n.x,ie=n.y,ce=5,X=Math.PI/ce;ce--;)V=n.x+Math.cos(L)*H,ie=n.y+Math.sin(L)*H,o.lineTo(V,ie),L+=X,V=n.x+Math.cos(L)*$,ie=n.y+Math.sin(L)*$,o.lineTo(V,ie),L+=X;else o.moveTo(Math.floor(n.x),Math.floor(n.y)),o.lineTo(Math.floor(n.wobbleX),Math.floor(g)),o.lineTo(Math.floor(v),Math.floor(y)),o.lineTo(Math.floor(f),Math.floor(n.wobbleY));return o.closePath(),o.fill(),n.tick<n.totalTicks}function U(o,n,h,f,g){var v=n.slice(),y=o.getContext("2d"),m,w,P=u(function(I){function M(){m=w=null,y.clearRect(0,0,f.width,f.height),E.clear(),g(),I()}function A(){i&&!(f.width===r.width&&f.height===r.height)&&(f.width=o.width=r.width,f.height=o.height=r.height),!f.width&&!f.height&&(h(o),f.width=o.width,f.height=o.height),y.clearRect(0,0,f.width,f.height),v=v.filter(function(_){return J(y,_)}),v.length?m=p.frame(A):M()}m=p.frame(A),w=M});return{addFettis:function(I){return v=v.concat(I),P},canvas:o,promise:P,reset:function(){m&&p.cancel(m),w&&w()}}}function oe(o,n){var h=!o,f=!!S(n||{},"resize"),g=!1,v=S(n,"disableForReducedMotion",Boolean),y=s&&!!S(n||{},"useWorker"),m=y?b():null,w=h?te:x,P=o&&m?!!o.__confetti_initialized:!1,I=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,M;function A(L,$,H){for(var V=S(L,"particleCount",O),ie=S(L,"angle",Number),ce=S(L,"spread",Number),X=S(L,"startVelocity",Number),Ye=S(L,"decay",Number),Ke=S(L,"gravity",Number),Je=S(L,"drift",Number),Ne=S(L,"colors",Q),Xe=S(L,"ticks",Number),Oe=S(L,"shapes"),Ze=S(L,"scalar"),Qe=!!S(L,"flat"),ke=se(L),De=V,Ce=[],et=o.width*ke.x,tt=o.height*ke.y;De--;)Ce.push(q({x:et,y:tt,angle:ie,spread:ce,startVelocity:X,color:Ne[De%Ne.length],shape:Oe[j(0,Oe.length)],ticks:Xe,decay:Ye,gravity:Ke,drift:Je,scalar:Ze,flat:Qe}));return M?M.addFettis(Ce):(M=U(o,Ce,w,$,H),M.promise)}function _(L){var $=v||S(L,"disableForReducedMotion",Boolean),H=S(L,"zIndex",Number);if($&&I)return u(function(X){X()});h&&M?o=M.canvas:h&&!o&&(o=k(H),document.body.appendChild(o)),f&&!P&&w(o);var V={width:o.width,height:o.height};m&&!P&&m.init(o),P=!0,m&&(o.__confetti_initialized=!0);function ie(){if(m){var X={getBoundingClientRect:function(){if(!h)return o.getBoundingClientRect()}};w(X),m.postMessage({resize:{width:X.width,height:X.height}});return}V.width=V.height=null}function ce(){M=null,f&&(g=!1,e.removeEventListener("resize",ie)),h&&o&&(document.body.contains(o)&&document.body.removeChild(o),o=null,P=!1)}return f&&!g&&(g=!0,e.addEventListener("resize",ie,!1)),m?m.fire(L,V,ce):A(L,V,ce)}return _.reset=function(){m&&m.reset(),M&&M.reset()},_}var ae;function Ae(){return ae||(ae=oe(null,{useWorker:!0,resize:!0})),ae}function He(o,n,h,f,g,v,y){var m=new Path2D(o),w=new Path2D;w.addPath(m,new DOMMatrix(n));var P=new Path2D;return P.addPath(w,new DOMMatrix([Math.cos(y)*g,Math.sin(y)*g,-Math.sin(y)*v,Math.cos(y)*v,h,f])),P}function Ve(o){if(!a)throw new Error("path confetti are not supported in this browser");var n,h;typeof o=="string"?n=o:(n=o.path,h=o.matrix);var f=new Path2D(n),g=document.createElement("canvas"),v=g.getContext("2d");if(!h){for(var y=1e3,m=y,w=y,P=0,I=0,M,A,_=0;_<y;_+=2)for(var L=0;L<y;L+=2)v.isPointInPath(f,_,L,"nonzero")&&(m=Math.min(m,_),w=Math.min(w,L),P=Math.max(P,_),I=Math.max(I,L));M=P-m,A=I-w;var $=10,H=Math.min($/M,$/A);h=[H,0,0,H,-Math.round(M/2+m)*H,-Math.round(A/2+w)*H]}return{type:"path",path:n,matrix:h}}function Ge(o){var n,h=1,f="#000000",g='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';typeof o=="string"?n=o:(n=o.text,h="scalar"in o?o.scalar:h,g="fontFamily"in o?o.fontFamily:g,f="color"in o?o.color:f);var v=10*h,y=""+v+"px "+g,m=new OffscreenCanvas(v,v),w=m.getContext("2d");w.font=y;var P=w.measureText(n),I=Math.ceil(P.actualBoundingBoxRight+P.actualBoundingBoxLeft),M=Math.ceil(P.actualBoundingBoxAscent+P.actualBoundingBoxDescent),A=2,_=P.actualBoundingBoxLeft+A,L=P.actualBoundingBoxAscent+A;I+=A+A,M+=A+A,m=new OffscreenCanvas(I,M),w=m.getContext("2d"),w.font=y,w.fillStyle=f,w.fillText(n,_,L);var $=1/h;return{type:"bitmap",bitmap:m.transferToImageBitmap(),matrix:[$,0,0,$,-I*$/2,-M*$/2]}}t.exports=function(){return Ae().apply(this,arguments)},t.exports.reset=function(){Ae().reset()},t.exports.create=oe,t.exports.shapeFromPath=Ve,t.exports.shapeFromText=Ge})(function(){return typeof window<"u"?window:typeof self<"u"?self:this||{}}(),Ie,!1);const gt=Ie.exports;Ie.exports.create;const pt="modulepreload",vt=function(c,e){return new URL(c,e).href},Be={},Te=function(e,t,i){let r=Promise.resolve();if(t&&t.length>0){const a=document.getElementsByTagName("link"),l=document.querySelector("meta[property=csp-nonce]"),d=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));r=Promise.allSettled(t.map(u=>{if(u=vt(u,i),u in Be)return;Be[u]=!0;const E=u.endsWith(".css"),p=E?'[rel="stylesheet"]':"";if(!!i)for(let N=a.length-1;N>=0;N--){const D=a[N];if(D.href===u&&(!E||D.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${u}"]${p}`))return;const C=document.createElement("link");if(C.rel=E?"stylesheet":pt,E||(C.as="script"),C.crossOrigin="",C.href=u,d&&C.setAttribute("nonce",d),document.head.appendChild(C),E)return new Promise((N,D)=>{C.addEventListener("load",N),C.addEventListener("error",()=>D(new Error(`Unable to preload CSS for ${u}`)))})}))}function s(a){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=a,window.dispatchEvent(l),!l.defaultPrevented)throw a}return r.then(a=>{for(const l of a||[])l.status==="rejected"&&s(l.reason);return e().catch(s)})},re=ue("Preferences",{web:()=>Te(()=>import("./web.DiSoNpLB.js"),[],import.meta.url).then(c=>new c.PreferencesWeb)});var we,z;class T{static async initialize(){if(!R(this,we))try{const e=await this.get(this.KEYS.SETTINGS);e?G(this,z,e):await this.set(this.KEYS.SETTINGS,R(this,z)),G(this,we,!0),console.log("✅ Storage inicializado:",R(this,z))}catch(e){console.error("❌ Error inicializando Storage:",e)}}static async get(e,t=null){try{const{value:i}=await re.get({key:e});return i?JSON.parse(i):t}catch{try{const i=localStorage.getItem(e);return i?JSON.parse(i):t}catch(i){return console.error(`Error leyendo ${e}:`,i),t}}}static async set(e,t){try{return await re.set({key:e,value:JSON.stringify(t)}),e===this.KEYS.SETTINGS&&G(this,z,t),!0}catch{try{return localStorage.setItem(e,JSON.stringify(t)),e===this.KEYS.SETTINGS&&G(this,z,t),!0}catch(i){return console.error(`Error guardando ${e}:`,i),!1}}}static get isVibrationEnabled(){return R(this,z).vibrationEnabled}static get isNotificationEnabled(){return R(this,z).notificationEnabled}static async setVibrationEnabled(e){return R(this,z).vibrationEnabled=e,this.set(this.KEYS.SETTINGS,R(this,z))}static async setNotificationEnabled(e){return R(this,z).notificationEnabled=e,this.set(this.KEYS.SETTINGS,R(this,z))}static async getCurrentLevel(){return this.get(this.KEYS.CURRENT_LEVEL)}static async setCurrentLevel(e){return this.set(this.KEYS.CURRENT_LEVEL,e)}static async getCurrentTheme(){return this.get(this.KEYS.THEME)}static async setCurrentTheme(e){return this.set(this.KEYS.THEME,e)}static async resetToDefaults(){G(this,z,{vibrationEnabled:!0,notificationEnabled:!0}),await Promise.all([this.set(this.KEYS.SETTINGS,R(this,z)),this.set(this.KEYS.THEME,"dark"),this.set(this.KEYS.CURRENT_LEVEL,Y[0])])}}we=new WeakMap,z=new WeakMap,ve(T,"KEYS",{THEME:"theme",CURRENT_LEVEL:"currentLevel",SETTINGS:"settings"}),he(T,we,!1),he(T,z,{vibrationEnabled:!0,notificationEnabled:!0});var We;(function(c){c[c.Sunday=1]="Sunday",c[c.Monday=2]="Monday",c[c.Tuesday=3]="Tuesday",c[c.Wednesday=4]="Wednesday",c[c.Thursday=5]="Thursday",c[c.Friday=6]="Friday",c[c.Saturday=7]="Saturday"})(We||(We={}));const le=ue("LocalNotifications",{web:()=>Te(()=>import("./web.B4BGIex0.js"),[],import.meta.url).then(c=>new c.LocalNotificationsWeb)}),Ee=ue("App",{web:()=>Te(()=>import("./web.0urCVRTF.js"),[],import.meta.url).then(c=>new c.AppWeb)});var Se;(function(c){c.Heavy="HEAVY",c.Medium="MEDIUM",c.Light="LIGHT"})(Se||(Se={}));var Me;(function(c){c.Success="SUCCESS",c.Warning="WARNING",c.Error="ERROR"})(Me||(Me={}));const be=ue("Haptics",{web:()=>Te(()=>import("./web.CYgRyw0C.js"),[],import.meta.url).then(c=>new c.HapticsWeb)});var Le;(function(c){c.Dark="DARK",c.Light="LIGHT",c.Default="DEFAULT"})(Le||(Le={}));var $e;(function(c){c.None="NONE",c.Slide="SLIDE",c.Fade="FADE"})($e||($e={}));const ye=ue("StatusBar");var fe,de,ge;class K{static async initializeServiceWorker(){if(W.isNative)return console.log("Plataforma nativa, omitiendo SW"),!0;console.group("🔄 Inicializando Service Worker");try{if(await this.cleanupServiceWorker(),G(this,de,await navigator.serviceWorker.register("sw.js",{scope:"./"})),await navigator.serviceWorker.ready,"Notification"in window){const e=await Notification.requestPermission();console.log("Permisos de notificación:",e)}return console.log("✅ Service Worker inicializado"),console.groupEnd(),!0}catch(e){return console.error("❌ Error inicializando SW:",e),console.groupEnd(),!1}}static async initialize(){console.group("🎮 Inicialización de GameSalad"),console.time("initialization");try{return console.log("Estado inicial:",{readyState:document.readyState,fontsLoaded:document.fonts.check('1em "Rubik"'),viewport:{width:window.innerWidth,height:window.innerHeight}}),await this.initializeStorage(),W.isNative&&await this.setupNativeServices(),G(this,fe,!0),console.timeEnd("initialization"),!0}catch(e){return console.error("[Capacitor] ❌ Error:",e),!1}finally{console.groupEnd()}}static async cleanupServiceWorker(){if("serviceWorker"in navigator)try{const e=await navigator.serviceWorker.getRegistrations();await Promise.all(e.map(i=>(console.log("Desregistrando SW:",i.scope),i.unregister())));const t=await caches.keys();await Promise.all(t.map(i=>(console.log("Eliminando caché:",i),caches.delete(i)))),console.log("✅ Service Workers y caches limpiados")}catch(e){console.warn("Error limpiando SW:",e)}}static async setupNativeServices(){console.group("[Capacitor] Configurando servicios nativos");const e=[{name:"App",instance:Ee},{name:"Haptics",instance:be},{name:"LocalNotifications",instance:le},{name:"Preferences",instance:re}];for(const{name:t,instance:i}of e)try{const r=W.isPluginAvailable(t);if(console.log(`- ${t}: ${r?"✓":"✗"}`),r&&i&&t==="LocalNotifications"){const s=await i.checkPermissions();console.log(`  Permisos: ${s.display}`)}}catch(r){console.warn(`❌ Error verificando ${t}:`,r)}try{W.getPlatform()==="ios"?(await ye.setOverlaysWebView(!0),await ye.setStyle({style:Le.Light})):(await ye.setOverlaysWebView(!1),await ye.setBackgroundColor({color:"#000000"}),await ye.setStyle({style:Le.Dark}))}catch(t){console.warn("[Capacitor] No se pudo configurar StatusBar:",t)}this.setupAppListeners(),console.log("✅ Configuración nativa completada"),console.groupEnd()}static async setupWebNotifications(){if("Notification"in window){const e=await Notification.requestPermission();console.log("Permisos de notificación web:",e)}}static async setupServiceWorker(){if(!R(this,fe))try{if(this.setupAppListeners(),G(this,ge,W.isNative),console.log("Plataforma nativa:",R(this,ge)),"serviceWorker"in navigator)try{!(window.location.hostname==="localhost"||window.location.hostname.includes("192.168.")||window.location.hostname.includes("127.0.0.1"))||window.location.protocol==="http:"?(G(this,de,await navigator.serviceWorker.register("/sw.js",{scope:"/",type:"classic",updateViaCache:"none"})),console.log("✅ Service Worker registrado:",R(this,de))):console.log("Service Worker no registrado en desarrollo local")}catch(e){console.warn("Service Worker no disponible:",e)}G(this,fe,!0),console.log("✅ Servicios nativos inicializados")}catch(e){console.error("❌ Error inicializando servicios nativos:",e)}}static setupAppListeners(){Ee.addListener("backButton",({canGoBack:e})=>{e||Ee.exitApp()}),Ee.addListener("appStateChange",({isActive:e})=>{e?document.dispatchEvent(new Event("appResume")):document.dispatchEvent(new Event("appPause"))})}static async initializeNotifications(){var e;if(console.group("🔔 Inicializando sistema de notificaciones"),R(this,ge))try{console.log("📱 Intentando usar notificaciones nativas...");const{display:t}=await le.checkPermissions();if(console.log("Estado de permisos nativos:",t),t==="granted"||t==="prompt"){const i=await le.requestPermissions();if(console.log("Nuevos permisos nativos:",i.display),i.display==="granted"){console.log("✅ Notificaciones nativas activadas"),console.groupEnd();return}}}catch(t){console.warn("❌ Notificaciones nativas no disponibles:",t)}if("Notification"in window)try{let t=Notification.permission;if(t==="default"&&(console.log("📱 Solicitando permisos de notificación..."),t=await Notification.requestPermission()),t==="granted"){(e=R(this,de))!=null&&e.active?console.log("✅ Service Worker notifications activadas"):console.log("✅ Web Notifications activadas"),console.groupEnd();return}else console.warn("❌ Permisos de notificación denegados:",t)}catch(t){console.warn("❌ Error solicitando permisos:",t)}console.warn("❌ No hay sistema de notificaciones disponible"),console.groupEnd()}static async vibrate(e="MEDIUM"){try{switch(e.toUpperCase()){case"LIGHT":await be.impact({style:Se.Light});break;case"HEAVY":await be.notification({type:Me.Success});break;case"MEDIUM":default:await be.impact({style:Se.Medium})}return!0}catch{return console.warn("Haptics no disponible"),!1}}static getIconPath(){console.group("🖼️ Obteniendo rutas de iconos");const e=W.getPlatform();let t;return e==="android"?t="ic_notification":e==="ios"?t="AppIcon":t="./assets/images/icon.png",console.log("Plataforma:",e),console.log("Icono seleccionado:",t),console.groupEnd(),t}static getBasePath(){const e=document.querySelector("base");if(e!=null&&e.href)return new URL(e.href).pathname;const t=window.location.pathname;return t.substring(0,t.lastIndexOf("/")+1)}static async sendNotification(e,t){console.group("📱 Enviando notificación");try{const i=W.getPlatform();if(console.log("Plataforma detectada:",i),i==="android"||i==="ios"){console.log(`Usando notificaciones nativas (${i})`);const r=await le.requestPermissions();if(console.log("Permisos:",r),r.display!=="granted")throw new Error(`Permiso denegado en ${i}`);const s=new Date(Date.now()+2e3),a={title:e,body:t,id:Math.floor(Date.now()/1e3),schedule:{at:s,allowWhileIdle:!0},autoCancel:!0,smallIcon:i==="android"?"ic_notification":"AppIcon",android:{channelId:"default",importance:4,priority:3,visibility:1,smallIcon:"ic_notification"}};return await le.schedule({notifications:[a]}),console.log(`✅ Notificación ${i} programada para:`,s),!0}if(typeof window>"u"||typeof window.Notification>"u")throw console.warn("❌ API Notification no está disponible"),new Error("Notificaciones web no soportadas");if(i!=="android"&&i!=="ios"&&!("Notification"in window))throw console.warn("❌ API Notification no está disponible en este entorno"),new Error("Notificaciones web no soportadas");if("Notification"in window&&"serviceWorker"in navigator){if(console.log("Usando notificaciones web"),await Notification.requestPermission()==="granted")return await(await navigator.serviceWorker.ready).showNotification(e,{body:t,icon:"assets/images/icon.png",vibrate:[200,100,200],requireInteraction:!0,data:{url:"."}}),console.log("✅ Notificación web enviada"),!0;throw new Error("Permiso de notificación denegado")}throw new Error("Sistema de notificaciones no disponible")}catch(i){throw console.error("❌ Error en notificación:",i),i}finally{console.groupEnd()}}static async scheduleNativeNotification(e,t,i){console.group("📱 Programando notificación nativa");try{console.log("Cancelando notificaciones anteriores..."),await le.cancel({notifications:[{id:1}]});const r=new Date(Date.now()+i*60*60*1e3);return console.log("Tiempo programado:",r),await le.schedule({notifications:[{title:e,body:t,id:1,schedule:{at:r,allowWhileIdle:!0},actionTypeId:"OPEN_APP"}]}),console.log("✅ Notificación nativa programada"),console.groupEnd(),!0}catch(r){return console.error("❌ Error en notificación nativa:",r),console.groupEnd(),!1}}static isMobile(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||"maxTouchPoints"in navigator&&navigator.maxTouchPoints>0}static async scheduleMobileNotification(e,t){console.group("📱 Programando Service Worker notification");try{const i=await navigator.serviceWorker.ready;return console.log("Service Worker listo"),await i.showNotification(e,{body:t,icon:"./assets/images/icon.png",vibrate:[200,100,200]}),console.log("✅ Service Worker notification mostrada"),console.groupEnd(),!0}catch(i){return console.error("❌ Error en Service Worker notification:",i),console.groupEnd(),!1}}static async saveData(e,t){try{return await re.set({key:e,value:JSON.stringify(t)}),!0}catch{return console.warn("Error guardando en Preferences, usando localStorage"),localStorage.setItem(e,JSON.stringify(t)),!1}}static async getData(e,t=null){try{const{value:i}=await re.get({key:e});return i?JSON.parse(i):t}catch{console.warn("Error leyendo de Preferences, usando localStorage");const i=localStorage.getItem(e);return i?JSON.parse(i):t}}static async removeData(e){try{return await re.remove({key:e}),!0}catch{return localStorage.removeItem(e),!1}}static async clearData(){try{return await re.clear(),!0}catch{return localStorage.clear(),!1}}static async logToNative(e,t={}){this._recentLogs||(this._recentLogs=new Set);const i=`${e}-${JSON.stringify(t)}`;this._recentLogs.has(i)||(this._recentLogs.add(i),setTimeout(()=>this._recentLogs.delete(i),1e3),W.getPlatform()==="android"?console.debug(`[GameSalad] ${e}`,JSON.stringify(t,null,2)):console.log(e,t))}static async initializeStorage(){try{if(W.isNative){const t="_test_storage_";await re.set({key:t,value:"test"}),await re.remove({key:t})}else{const t="_test_storage_";localStorage.setItem(t,"test"),localStorage.removeItem(t)}const e={vibrationEnabled:await this.getData("vibrationEnabled",!0),notificationEnabled:await this.getData("notificationEnabled",!0)};return console.log("✅ Storage inicializado:",e),e}catch(e){return console.error("❌ Error inicializando Storage:",e),{vibrationEnabled:!0,notificationEnabled:!0}}}static async adjustTitle(e,t,i,r){const s=(performance.now()/1e3).toFixed(3);console.log(`⏱️ [${s}] Ajustando título:`,{texto:e,contenedor:t,disponible:i,anchoActual:r});const a=e==="VG Characters";if(!e||r<=i)return console.log(`⏱️ [${s}] No necesita ajuste`),a&&document.dispatchEvent(new CustomEvent("title-adjusted",{detail:{timestamp:s,texto:e,anchoActual:r,disponible:i,final:!0}})),!0;document.dispatchEvent(new CustomEvent("title-adjusted",{detail:{timestamp:s,texto:e,anchoActual:r,disponible:i,needed:!0}}))}}fe=new WeakMap,de=new WeakMap,ge=new WeakMap,he(K,fe,!1),he(K,de,null),he(K,ge,!1);class Z{static async measureText(e,t){const i=document.createElement("div");i.style.cssText=`
            position: absolute;
            visibility: hidden;
            white-space: pre;
            ${Object.entries(t).map(([s,a])=>`${s}:${a}`).join(";")}
        `,i.textContent=e,document.body.appendChild(i);const r={width:i.offsetWidth,height:i.offsetHeight,left:i.offsetLeft,top:i.offsetTop};return document.body.removeChild(i),r}static animateWordFound(e,t,i){return new Promise(r=>{const s=document.getElementById(`tile-${e[e.length-1]}`),a=s.querySelector(".text"),l=t.querySelector("span");l.style.opacity="0";const d=window.getComputedStyle(l),u={source:window.getComputedStyle(a),target:window.getComputedStyle(t)};(async()=>{const E=await Promise.all([...i].map(async O=>this.measureText(O,{"font-size":d.fontSize,"font-family":"var(--font-family-content)","font-weight":u.target.fontWeight,"letter-spacing":u.target.letterSpacing,"text-transform":u.target.textTransform,"font-feature-settings":u.target.fontFeatureSettings}))),p=E.reduce((O,j)=>O+j.width,0),b=l.getBoundingClientRect(),C=s.getBoundingClientRect(),N=(b.width-p)/2,D=[...i].map((O,j)=>{const B=document.createElement("span");B.textContent=O===" "?" ":O,B.className="animated-letter";const Q=C.left+C.width/2,ee=C.top+C.height/2;B.style.cssText=`
                        position: fixed;
                        left: ${Q}px;
                        top: ${ee}px;
                        transform: translate(-50%, -50%);
                        opacity: 1;
                    `,document.body.appendChild(B);const se=E.slice(0,j).reduce((k,F)=>k+F.width,0),te=b.left+N+se+E[j].width/2,x=b.top+b.height/2;return{element:B,endX:te,endY:x,startX:Q,startY:ee,sourceStyles:u.source,targetStyles:u.target}});D.forEach(({element:O,endX:j,endY:B,startX:Q,startY:ee},se)=>{setTimeout(()=>{O.classList.add("animating"),requestAnimationFrame(()=>{O.classList.add("in-transit");const te=j-Q,x=B-ee;O.style.cssText+=`
                                font-size: ${d.fontSize};
                                color: white;
                                transform: translate(
                                    calc(-50% + ${te}px),
                                    calc(-50% + ${x}px)
                                );
                            `;const k=F=>{F.propertyName==="transform"&&(O.removeEventListener("transitionend",k),O.classList.remove("animating","in-transit"),se===D.length-1&&(l.textContent=i,l.style.opacity="1",requestAnimationFrame(()=>{document.querySelectorAll(".animated-letter").forEach(q=>q.remove())})))};O.addEventListener("transitionend",k)})},se*this.DURATIONS.LETTER_DELAY)}),e.forEach(O=>{document.getElementById(`tile-${O}`).classList.add("found-temp")});const S=D.length*this.DURATIONS.LETTER_DELAY+this.DURATIONS.LETTER_ANIMATION;setTimeout(()=>{e.forEach(O=>{document.getElementById(`tile-${O}`).classList.remove("found-temp")}),r(S)},S)})()})}static async animateUnusedCells(e){e.forEach(t=>{const i=document.getElementById(`tile-${t}`);requestAnimationFrame(()=>i.classList.add("unused"))})}static async animateVictory(e){document.getElementById("victory-modal").classList.add("active"),await new Promise(i=>requestAnimationFrame(i)),await this.confetti.start(),e==null||e()}static resetSelectionWithDelay(e){setTimeout(()=>e.reset(),this.DURATIONS.SELECTION_RESET)}static updateCellStates(e,{add:t=[],remove:i=[]}){e.forEach(r=>{t.length&&requestAnimationFrame(()=>r.classList.add(...t)),i.length&&r.classList.remove(...i)})}static stopConfetti(){this.confetti.stop()}static cleanupAnimations(){const e=document.querySelectorAll(".animated-letter");e.length>0&&e.forEach(t=>t.remove())}static bindDebugEvents(){document.addEventListener("keydown",e=>{if(e.key.toLowerCase()==="t"&&this.confetti.test(),!isNaN(parseInt(e.key))&&e.key!=="0"){const t=parseInt(e.key)/10;this.confetti.test(t)}})}}ve(Z,"DURATIONS",{LETTER_DELAY:50,LETTER_ANIMATION:300,VICTORY_DELAY:300}),ve(Z,"confetti",{instance:null,async initialize(){const e=document.getElementById("confetti-canvas");if(!e){console.warn("❌ No se encontró el canvas");return}try{this.instance=gt.create(e,{resize:!0})}catch(t){console.error("❌ Error creando instancia:",t)}},async fire(e){this.instance||await this.initialize(),this.instance&&this.instance(e)},getColors(){const e=getComputedStyle(document.documentElement).getPropertyValue("--confetti-colors").trim();return e?e.split(",").map(t=>t.trim()):["#ffd700","#ff3939","#00ff7f","#4169e1","#ff69b4"]},stop(){this.instance&&(this.instance.reset(),this.instance=null)},start(){return new Promise(e=>{(async()=>{this.instance||await this.initialize();const i=this.getColors();await this.executeFirstWave(i),await new Promise(r=>setTimeout(r,250)),await this.executeSecondWave(i),e()})()})},async executeConfettiSequence(e){const t=this.getColors();await this.executeFirstWave(t),await new Promise(i=>setTimeout(i,250)),await this.executeSecondWave(t),e()},async executeFirstWave(e){this.fire({particleCount:100,spread:70,origin:{x:.1,y:.35},colors:e}),this.fire({particleCount:100,spread:70,origin:{x:.9,y:.35},colors:e}),T.isVibrationEnabled&&await K.vibrate("MEDIUM")},async executeSecondWave(e){this.fire({particleCount:150,spread:100,origin:{x:.5,y:.3},gravity:1.2,scalar:1.2,drift:0,ticks:300,colors:e}),T.isVibrationEnabled&&await K.vibrate("HEAVY")},test(e=.5,t=.35){this.fire({particleCount:50,spread:70,origin:{x:e,y:t},colors:this.getColors()})}});Z.bindDebugEvents();class yt{constructor(){this.currentTheme="dark",this.availableThemes=new Map,this.categoryOrder=[],this.loadedStylesheets=new Set,this.loadedFonts=new Set,this.singleWordTerms=new Set(["pac-man"]),this._styleCache=new Map,this._previewStyles=new Map,this._themeLoadPromise=null,this._activeTheme=null,this._pendingThemeLoad=null,this._activeStyleElement=null,this._styleElement=document.createElement("style"),this._themesStyleElement=document.createElement("style"),this._themesStyleElement.id="theme-styles",this._themeGrid=null}loadThemeData(){var e;if(this.themesData=this.extractThemesFromCSS(),!((e=this.themesData)!=null&&e.categories)){console.error("❌ No se encontraron datos de temas");return}this.categoryOrder=[],this.availableThemes.clear(),Object.entries(this.themesData.categories).forEach(([t,i])=>{this.categoryOrder.push(t),i.themes.forEach(r=>{this.availableThemes.set(r.file.replace(".css",""),r.name)})}),this._themeGrid=document.querySelector(".theme-grid"),this._themeGrid&&this.generateThemeGrid(),wt({categorías:this.categoryOrder,temas:Array.from(this.availableThemes.entries())},"loadThemeData")}extractThemesFromCSS(){var i,r,s;const e={categories:{basic:{themes:[]},"modern-games":{themes:[]},"retro-games":{themes:[]}}},t=Array.from(document.styleSheets);try{for(const a of t)if(a.href&&a.href.includes("styles.css")){const l=Array.from(a.cssRules||[]);for(const d of l)if((i=d.selectorText)!=null&&i.startsWith("[data-theme")){const u=(r=d.selectorText.match(/\[data-theme="([^"]+)"\]/))==null?void 0:r[1];if(u){const E=d.cssText||((s=d.style)==null?void 0:s.cssText),p=E.match(/--theme-name:\s*['"]([^'"]+)['"]/),b=E.match(/--theme-category:\s*['"]([^'"]+)['"]/);if(p&&b){const C=p[1],N=b[1];e.categories[N]||(e.categories[N]={themes:[]}),e.categories[N].themes.push({name:C,file:u})}}}}}catch(a){console.error("Error extrayendo temas del CSS:",a)}return e}generateThemeGrid(){if(!this._themeGrid){console.error("❌ Elemento theme-grid no encontrado");return}this._themeGrid.innerHTML="",Object.entries(this.themesData.categories).forEach(([t,i])=>{const r=t.split("-").map(a=>a.charAt(0).toUpperCase()+a.slice(1)).join(" "),s=document.createElement("div");s.className="theme-category",s.textContent=r,this._themeGrid.appendChild(s),i.themes.forEach(a=>{const l=a.file.replace(".css",""),d=document.createElement("button");d.className="theme-option",d.dataset.theme=l;const u=document.createElement("div");u.className="preview-wrapper";const E=document.createElement("div");E.className="preview-cell";const p=document.createElement("div");p.className="preview-text",p.textContent="A",E.appendChild(p);const b=document.createElement("div");b.className="preview-mark",E.appendChild(b);const C=document.createElement("div");C.className="preview-title",C.textContent=a.name,u.appendChild(E),u.appendChild(C),d.appendChild(u),d.addEventListener("click",()=>this.setTheme(l)),this._themeGrid.appendChild(d)})});const e=document.querySelector(".back-button");e&&e.addEventListener("click",()=>{const t=document.getElementById("theme-modal"),i=document.getElementById("modal");t&&i&&(t.classList.remove("active"),i.classList.add("active"))})}async injectBaseStyles(){console.log("💉 Inyectando estilos base..."),this.loadThemeData(),await new Promise(e=>{requestAnimationFrame(()=>setTimeout(e,100))})}getThemeStyles(){var e;return(e=this.themesData)!=null&&e.categories||console.error("❌ No hay datos de temas"),""}async initialize(){console.group("[ThemeSelector] Inicializando");try{const e=await T.get(T.KEYS.THEME,"dark");return console.log("Tema guardado:",e),this._pendingTheme=e,await this.injectBaseStyles(),this.loadThemeData(),console.log("✅ ThemeSelector preparado"),!0}catch(e){return console.error("❌ Error:",e),document.documentElement.setAttribute("data-theme","dark"),!1}finally{console.groupEnd()}}async applyPendingTheme(){if(this._pendingTheme){console.log("🎨 Aplicando tema:",this._pendingTheme);try{await this.loadFontsForTheme(this._pendingTheme),document.documentElement.setAttribute("data-theme",this._pendingTheme),this._activeTheme=this._pendingTheme,await document.fonts.ready,await new Promise(e=>setTimeout(e,100)),this._pendingTheme=null,console.log("✅ Tema aplicado")}catch(e){console.error("❌ Error aplicando tema:",e)}}}async parseFonts(){const e=new Set;return document.querySelectorAll('link[rel="stylesheet"][href*="fonts.googleapis.com"]').forEach(t=>{e.add(t.href)}),Array.from(e)}async loadFontsForTheme(e){try{const i=(await this.parseFonts()).map(r=>{const s=document.createElement("link");return s.rel="stylesheet",s.href=r,s});await Promise.all(i.map(r=>new Promise((s,a)=>{r.onload=()=>s(),r.onerror=()=>a(),document.head.appendChild(r)}))),await document.fonts.ready,console.log("✅ Fuentes cargadas para el tema:",e)}catch(t){console.error("❌ Error cargando fuentes:",t)}}async preloadFontsForTheme(e){try{console.log("🔤 Precargando fuentes para:",e);const i=(await this.parseFonts()).map(r=>{const s=document.createElement("link");return s.rel="stylesheet",s.href=r,s});await Promise.all(i.map(r=>new Promise(s=>{r.onload=s,r.onerror=s,document.head.appendChild(r)}))),await document.fonts.ready,console.log("✅ Fuentes cargadas")}catch(t){console.error("❌ Error cargando fuentes:",t)}}async setTheme(e){if(this._activeTheme===e)return!0;try{return console.group("🎨 Cambiando tema a:",e),document.documentElement.setAttribute("data-theme",e),await this.loadFontsForTheme(e),await document.fonts.ready,this._activeTheme=e,await T.setCurrentTheme(e),window.dispatchEvent(new CustomEvent("themechange",{detail:{theme:e}})),console.log("✅ Tema aplicado"),console.groupEnd(),!0}catch(t){return console.error("❌ Error aplicando tema:",t),console.groupEnd(),!1}}}const Ue=new Set;function wt(c,e){const t=`${e}-${JSON.stringify(c)}`;Ue.has(t)||(console.log("✅ Temas cargados:",c),Ue.add(t))}class Et{constructor(e){this.titleElement=e,this.originalSize=parseFloat(getComputedStyle(e).fontSize),this.fit=this.fit.bind(this),this.observe(),this.bindEvents()}observe(){this.observer=new MutationObserver(this.fit),this.observer.observe(this.titleElement,{childList:!0,characterData:!0,subtree:!0})}bindEvents(){window.addEventListener("resize",()=>{requestAnimationFrame(this.fit)})}fit(){const e=this.titleElement,t=e.parentElement,i=30;e.style.fontSize=`${this.originalSize}px`;const r=Math.min(1,(t.clientWidth-i)/e.scrollWidth);e.style.fontSize=`${this.originalSize*r}px`}destroy(){this.observer.disconnect()}}const me=class me{constructor(){if(me.instance)return me.instance;me.instance=this,console.group("🎮 GameState Constructor");const e="base-styles";if(!document.getElementById(e)){console.log("💉 Inyectando estilos base...");const t=document.createElement("style");t.id=e,t.textContent=`
                @keyframes rotation {
                    0% { transform: rotate(0deg); }
                    100% { transform: rotate(360deg); }
                }
                .loader {
                    width: 48px;
                    height: 48px;
                    border: 5px solid #fff;
                    border-bottom-color: transparent;
                    border-radius: 50%;
                    display: inline-block;
                    animation: rotation 1s linear infinite;
                }
                .js-loading-overlay {
                    position: fixed;
                    inset: 0;
                    background: #121212;
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    z-index: 9999;
                    opacity: 1;
                    transition: opacity 0.3s ease-out;
                }
                .js-loading-overlay.hidden {
                    opacity: 0;
                    pointer-events: none;
                }
            `,document.head.appendChild(t)}document.getElementById(e)&&document.getElementById(e).remove(),window.themeSelector||(window.themeSelector=new yt),this.themeSelector=window.themeSelector,console.log("✅ GameState inicializado"),console.groupEnd(),this._lastAppliedTheme=null}async initialize(){console.group("🔄 Inicialización");try{await this.themeSelector.injectBaseStyles(),await this.themeSelector.initialize();const e=await T.get(T.KEYS.THEME,"dark");await Promise.all([this.themeSelector.setTheme(e),T.initialize()]),this.initializeElements(),this.initializeState(),this.initializeBoard();const t=Y[0],i=await T.getCurrentLevel(),r=i&&ne[i]?i:t;this.currentLevel={...ne[r],id:r,name:ne[r].name},this.bindEvents(),await this.updateAllWithoutTitleFit(r),document.dispatchEvent(new CustomEvent("initialization-complete")),this.titleFitter&&(await this.titleFitter.fit(),requestAnimationFrame(()=>{document.dispatchEvent(new CustomEvent("title-adjusted",{detail:{final:!0}}))})),K.initializeServiceWorker().then(()=>{document.dispatchEvent(new CustomEvent("sw-ready"))}),console.log("✅ Inicialización completada")}catch(e){console.error("❌ Error:",e),this.handleInitializationError()}console.groupEnd()}handleInitializationError(){const e=Y[0];console.log("Recuperando con nivel por defecto:",e),this.currentLevel={...ne[e],id:e,name:ne[e].name},this.initializeElements(),this.initializeState(),this.initializeBoard(),this.updateAll(e),this.showContent()}async onAppPause(){this.timer&&!this.timer.isPaused&&(this.pauseTimer(),this._wasTimerRunning=!0),await T.setCurrentLevel(this.currentLevel.id)}onAppResume(){var e;this.checkAndHandleDataReset(),this._wasTimerRunning&&((e=this.timer)!=null&&e.isPaused)&&(this.resumeTimer(),this._wasTimerRunning=!1)}async saveGameState(){try{await T.setCurrentLevel(this.currentLevel.id)}catch(e){console.error("Error guardando estado:",e)}}async checkAndHandleDataReset(){try{await T.get(T.KEYS.THEME)||await this.handleDataReset()}catch(e){console.error("Error verificando datos:",e),await this.handleDataReset()}}async handleDataReset(){try{await T.resetToDefaults(),await this.themeSelector.initialize(),await this.loadLevel(Y[0])}catch(e){console.error("Error reinicializando datos:",e)}}async initializeGame(){await T.initialize();const e=await T.get(T.KEYS.CURRENT_LEVEL,Y[0]);this.currentLevel={...ne[e],id:e}}async initPhase1(){try{await this.themeSelector.initialize(),this.initializeElements(),this.initializeState(),this.initializeBoard(),this.bindEvents()}catch(e){console.error("Error in initPhase1:",e),document.documentElement.setAttribute("data-theme","dark")}}async initPhase2(){const e=await T.get(T.KEYS.CURRENT_LEVEL,Y[0]);this.currentLevel={...ne[e],id:e},this.updateAll(this.currentLevel.id),this.showContent()}setTheme(e){return this.themeSelector.setTheme(e)}async handleThemeChange(e){console.group("🔄 Cambio de tema:",e);try{if(this._lastAppliedTheme===e){console.log("⏩ Tema ya aplicado, omitiendo...");return}console.log("🎨 Aplicando tema..."),await this.themeSelector.setTheme(e),this._lastAppliedTheme=e,console.log("🔄 Reseteando estilos del título..."),this.titleElement.style="",console.log("⌛ Esperando fuentes..."),await document.fonts.ready;const t=getComputedStyle(this.titleElement);console.log("🔤 Precargando fuente:",t.fontFamily),await document.fonts.load(`${t.fontSize} ${t.fontFamily}`),this.titleFitter&&(console.log("📏 Ajustando título..."),await this.titleFitter.fit()),console.log("📝 Actualizando lista de palabras..."),this.updateWordList(),console.log("✅ Cambio de tema completado")}catch(t){console.error("❌ Error al cambiar tema:",t)}console.groupEnd()}async showContent(){var e;console.group("👁️ Mostrando Contenido");try{const t=document.querySelector(".js-loading-overlay"),i=t.querySelector(".progress-bar");i.style.transform="scaleX(0)",await new Promise(s=>requestAnimationFrame(s)),document.documentElement.setAttribute("data-theme","dark"),await this.themeSelector.injectBaseStyles(),i.style.animationPlayState="running",await this.themeSelector.initialize();const r=await T.get(T.KEYS.THEME,"dark");await this.themeSelector.setTheme(r),await document.fonts.ready,await new Promise(s=>{i.addEventListener("animationend",s,{once:!0})}),t.classList.add("fade-out")}catch(t){console.error("❌ Error:",t),(e=document.querySelector(".js-loading-overlay"))==null||e.remove()}finally{document.body.classList.remove("js-loading"),console.groupEnd()}}async updateAllWithoutTitleFit(e){var t;(t=this.currentLevel)!=null&&t.data&&(this.updateBoard(),this.updateTitleContent(),this.updateWordList(),this.updateUnusedLetters(),this.updateLevelNumber(e),this.resetTimer(),this.startTimer())}updateTitleContent(){var r;if(!this.titleElement||!((r=this.currentLevel)!=null&&r.name))return;const e="user-select: text; -webkit-user-select: text; -moz-user-select: text;",i=W.getPlatform()==="android"?"16px":"24px";this.titleElement.textContent=this.currentLevel.name,this.titleElement.style.cssText=`${e}; font-size: ${i};`}async fitTitle(){if(!(this._titleFitInProgress||!this.titleFitter))try{this._titleFitInProgress=!0,await this.titleFitter.fit()}finally{this._titleFitInProgress=!1}}initializeElements(){try{const e={titleContainer:document.querySelector(".title-container"),titleElement:document.querySelector(".title"),board:document.querySelector(".board"),wordList:document.querySelector(".word-list"),levelNumber:document.querySelector(".level-number"),timerElement:document.querySelector(".timer")};if(!e.titleElement||!e.board)throw new Error("Elementos críticos no encontrados");if(Object.entries(e).forEach(([t,i])=>{i||console.warn(`Elemento ${t} no encontrado`),this[t]=i}),this.timer={element:this.timerElement,startTime:0,elapsed:0,interval:null,isPaused:!1},this.titleElement){this.titleFitter=new Et(this.titleElement);const t=W.getPlatform()==="android",i="user-select: text; -webkit-user-select: text; -moz-user-select: text;",r=t?"16px":"24px";this.titleElement.style.cssText=`${i}; font-size: ${r};`}}catch(e){throw console.error("Error inicializando elementos:",e),e}}initializeState(){this.currentLevel=null,this.foundWords=new Set,this.usedLetters=new Set,this.availableThemes=new Map,this.themeDisplayNames=new Map,this.categoryOrder=[],this.selectionManager=new ft(this.board,null,e=>this.onSelectionUpdate(e))}onSelectionUpdate(e){this.checkWord(e)&&Z.resetSelectionWithDelay(this.selectionManager)}initializeBoard(){const e=document.createDocumentFragment();for(let t=1;t<=16;t++){const i=String.fromCharCode(96+Math.ceil(t/4)),r=(t-1)%4+1,s=`${i}${r}`,a=document.createElement("div");a.className="cell",a.id=`tile-${s}`,a.innerHTML=`
                <div class="hitbox" data-position="${s}"></div>
                <div class="mark" id="mark-${s}"></div>
                <div class="text" id="letter-${s}"></div>
            `,e.appendChild(a)}this.board.appendChild(e)}updateBoard(){var i;if(!((i=this.currentLevel)!=null&&i.data)){console.warn("No hay nivel actual o datos para mostrar");return}const e=Array(4).fill().map(()=>Array(4).fill("")),t=Array(16).fill().map((r,s)=>{const a=String.fromCharCode(96+Math.ceil((s+1)/4)),l=s%4+1;return`${a}${l}`});t.forEach(r=>document.getElementById(`tile-${r}`).classList.remove("found-temp","unused")),Object.entries(this.currentLevel.data).forEach(([r,s])=>{r.replace(/\s+/g,"").split("").forEach((a,l)=>{const d=s.slice(l*2,l*2+2);if(d.length===2){const u=d.charCodeAt(0)-97,E=parseInt(d[1])-1;u>=0&&u<4&&E>=0&&E<4&&!e[u][E]&&(e[u][E]=a)}})}),t.forEach((r,s)=>{document.getElementById(`letter-${r}`).textContent=e[Math.floor(s/4)][s%4]})}resetSelection(){this.selectionManager.reset()}async loadLevel(e){Z.stopConfetti(),this.resetControls(),document.querySelectorAll(".animated-letter").forEach(t=>t.remove()),this.currentLevel={...ne[e],id:e},[this.foundWords,this.usedLetters].forEach(t=>t.clear()),this.resetSelection(),this.updateAll(e),await T.setCurrentLevel(e)}updateAll(e){var t;if(!((t=this.currentLevel)!=null&&t.data)){console.error("❌ No hay nivel actual para actualizar",{levelId:e,currentLevel:this.currentLevel});return}this.updateBoard(),this.updateTitle(),this.titleFitter&&requestAnimationFrame(()=>this.titleFitter.fit()),this.updateWordList(),this.updateUnusedLetters(),this.updateLevelNumber(e),this.resetTimer(),this.startTimer()}updateTitle(){var e;if(!this.titleElement&&(console.error("Título no encontrado, reinicializando elementos..."),this.initializeElements(),!this.titleElement)){console.error("No se pudo recuperar el elemento título");return}if(!((e=this.currentLevel)!=null&&e.name)){console.error("Nivel actual sin nombre:",this.currentLevel);return}try{const t="user-select: text; -webkit-user-select: text; -moz-user-select: text;";this.titleElement.textContent=this.currentLevel.name;const r=W.getPlatform()==="android"?"16px":"24px";this.titleElement.style.cssText=`${t}; font-size: ${r};`,this.titleFitter&&requestAnimationFrame(()=>this.titleFitter.fit()),console.log("Título actualizado:",{contenido:this.currentLevel.name,elemento:this.titleElement.textContent,estilos:this.titleElement.style.cssText})}catch(t){console.error("Error actualizando título:",t)}}updateWordList(){var r;if(!this.wordList||!((r=this.currentLevel)!=null&&r.data)){console.warn("No hay lista de palabras o nivel actual");return}this.wordList.innerHTML="";const e=document.createDocumentFragment(),t=Object.keys(this.currentLevel.data).sort((s,a)=>s.localeCompare(a)),i=document.createElement("div");i.className="word word-measure",i.style.cssText=`
            position: absolute;
            visibility: hidden;
            height: auto;
            width: auto;
            white-space: nowrap;
        `,document.body.appendChild(i),t.forEach((s,a)=>{const l=document.createElement("div");l.className="word",l.setAttribute("data-index",a);const d=this.foundWords.has(s),u=document.createElement("span");if(i.textContent=s+"M",l.style.setProperty("--word-content-width",`${i.offsetWidth}px`),d)l.classList.add("found"),u.textContent=s;else{const E=s.split(" ").map(p=>p.length);u.innerHTML=`<span class="word-length">${E.join(", ")}</span>`}l.appendChild(u),e.appendChild(l)}),document.body.removeChild(i),this.wordList.appendChild(e)}checkWord(e){if(!(e!=null&&e.length))return!1;const t=e.join("");for(const[i,r]of Object.entries(this.currentLevel.data))if(r===t&&!this.foundWords.has(i)){const s=Object.keys(this.currentLevel.data).sort((l,d)=>l.localeCompare(d)).indexOf(i),a=this.wordList.querySelector(`[data-index="${s}"]`);return a!=null&&a.classList.contains("found")?!1:(this.foundWords.add(i),a&&(a.classList.add("found","found-initial"),a.addEventListener("animationend",()=>{a.classList.remove("found-initial")},{once:!0})),this.animateFound(e),this.resetControls(),!0)}return!1}async animateFound(e){var r;const t=e.join(""),i=(r=Object.entries(this.currentLevel.data).find(([,s])=>s===t))==null?void 0:r[0];if(i){T.isVibrationEnabled&&await K.vibrate(),this.foundWords.size===Object.keys(this.currentLevel.data).length&&(this.pauseTimer(),document.getElementById("final-time").textContent=this.timer.element.textContent);const s=Object.keys(this.currentLevel.data).sort((l,d)=>l.localeCompare(d)).indexOf(i),a=this.wordList.querySelector(`[data-index="${s}"]`);if(!a)return;await Z.animateWordFound(e,a,i),this.updateUnusedLetters(),this.foundWords.size===Object.keys(this.currentLevel.data).length&&this.onLevelComplete()}}updateUnusedLetters(){var t;this.usedLetters.clear(),Object.entries(this.currentLevel.data).forEach(([i,r])=>{if(!this.foundWords.has(i))for(let s=0;s<r.length;s+=2){const a=r.slice(s,s+2);a.length===2&&this.usedLetters.add(a)}});const e=[];for(let i=1;i<=16;i++){const r=String.fromCharCode(96+Math.ceil(i/4)),s=(i-1)%4+1,a=`${r}${s}`,l=document.getElementById(`tile-${a}`);if(!this.usedLetters.has(a))e.push(a),(t=l.querySelector(".hitbox"))==null||t.remove();else if(Z.updateCellStates([l],{remove:["unused"]}),!l.querySelector(".hitbox")){const d=document.createElement("div");d.className="hitbox",d.dataset.position=a,l.insertBefore(d,l.firstChild)}}e.length&&Z.animateUnusedCells(e)}onLevelComplete(){T.isVibrationEnabled&&K.vibrate("HEAVY"),Z.animateVictory(()=>{this.showVictoryModal()})}bindEvents(){Object.entries({touchstart:"handlePointerDown",touchmove:"handleTouchMove",touchend:"handlePointerUp",touchcancel:"handlePointerUp",mousedown:"handlePointerDown",mousemove:"handlePointerMove",mouseup:"handlePointerUp",mouseleave:"handlePointerOut",mouseenter:"handlePointerEnter"}).forEach(([s,a])=>{this.board.addEventListener(s,l=>this.selectionManager[a].call(this.selectionManager,l),{passive:!1})}),window.addEventListener("themechange",s=>{this.handleThemeChange(s.detail.theme)}),this.bindModalEvents(),window.addEventListener("resize",()=>this.selectionManager.drawLine()),document.addEventListener("click",s=>{const a=s.target;a.closest("#victory-modal")||a.closest(".modal-content")||a.closest(".menu")||a.closest(".board")||(this.selectionManager.reset(),a.closest(".modal-overlay")&&this.handleModalClose())}),new ResizeObserver(()=>{requestAnimationFrame(()=>{Z.cleanupAnimations(),this.updateWordList()})}).observe(document.documentElement);const t={"vibration-toggle":async()=>{try{const s=document.getElementById("vibration-toggle"),a=!T.isVibrationEnabled;await T.setVibrationEnabled(a),s.textContent=a?"Desactivar Vibración":"Activar Vibración",a&&await K.vibrate("LIGHT")}catch(s){console.error("Error al cambiar estado de vibración:",s)}},"test-notification":async()=>{console.group("🔔 Test Notificación");try{console.log("1. Inicializando notificaciones..."),await K.initializeNotifications(),console.log("2. Activando notificaciones..."),await T.setNotificationEnabled(!0),console.log("3. Intentando enviar notificación..."),await K.sendNotification("¡Hora de jugar!","Te esperan nuevos desafíos en GameSalad"),console.log("✅ Notificación enviada con éxito")}catch(s){console.error("❌ Error en notificación:",s)}finally{console.groupEnd()}}},i=document.getElementById("vibration-toggle");i&&(i.textContent=T.isVibrationEnabled?"Desactivar Vibración":"Activar Vibración"),Object.entries(t).forEach(([s,a])=>{var l;(l=document.getElementById(s))==null||l.addEventListener("click",a)}),Object.entries({"reset-game":()=>{this.resetTimer(),this.loadLevel(this.currentLevel.id),document.getElementById("modal").classList.remove("active")},"restart-level":()=>{this.resetTimer(),this.loadLevel(this.currentLevel.id),document.getElementById("victory-modal").classList.remove("active")},"next-level":()=>{const a=Y.indexOf(this.currentLevel.id)+1;a<Y.length?(this.resetTimer(),this.loadLevel(Y[a]),document.getElementById("victory-modal").classList.remove("active")):(this.resetTimer(),this.loadLevel(Y[0]),document.getElementById("victory-modal").classList.remove("active"))}}).forEach(([s,a])=>{var l;(l=document.getElementById(s))==null||l.addEventListener("click",a)}),document.addEventListener("appPause",()=>{this.onAppPause()}),document.addEventListener("appResume",()=>{this.onAppResume()}),document.addEventListener("visibilitychange",()=>{document.hidden?this.onAppPause():this.onAppResume()})}bindModalEvents(){var s;const e={menu:document.querySelector(".menu"),modal:document.getElementById("modal"),themeModal:document.getElementById("theme-modal"),victoryModal:document.getElementById("victory-modal")},t=()=>Object.values(e).some(a=>a==null?void 0:a.classList.contains("active")),i=a=>{(a==null?void 0:a.id)!=="victory-modal"&&(a==null||a.classList.remove("active"),t()||this.resumeTimer())};Object.entries({menu:()=>{e.modal.classList.add("active"),this.pauseTimer()},"theme-button":()=>{e.modal.classList.remove("active"),e.themeModal.classList.add("active")},"back-button":()=>{e.themeModal.classList.remove("active"),e.modal.classList.add("active")}}).forEach(([a,l])=>{var d;(d=document.querySelector(a==="menu"?".menu":`#${a}`))==null||d.addEventListener("click",u=>{u.stopPropagation(),l()})}),(s=e.victoryModal)==null||s.addEventListener("click",a=>{a.target===e.victoryModal&&a.stopPropagation()}),document.querySelectorAll(".modal-overlay").forEach(a=>{a.id!=="victory-modal"&&a.addEventListener("click",l=>{l.target===a&&(i(a),t()||this.resumeTimer())})})}handleModalClose(){const e=document.querySelector(".modal-overlay.active:not(#victory-modal)");e&&(e.classList.remove("active"),document.querySelector(".modal-overlay.active")||this.resumeTimer())}startTimer(){this.timer.startTime=Date.now()-this.timer.elapsed,this.timer.isPaused=!1,this.timer.interval&&clearInterval(this.timer.interval),this.timer.interval=setInterval(()=>{this.timer.isPaused||(this.timer.elapsed=Date.now()-this.timer.startTime,this.updateTimerDisplay())},100)}pauseTimer(){this.timer.isPaused||(this.timer.isPaused=!0,this.timer.elapsed=Date.now()-this.timer.startTime,this.saveGameState())}resumeTimer(){this.timer.isPaused&&(this.timer.isPaused=!1,this.timer.startTime=Date.now()-this.timer.elapsed)}resetTimer(){this.timer.interval&&clearInterval(this.timer.interval),this.timer.elapsed=0,this.timer.isPaused=!1,this.updateTimerDisplay()}updateTimerDisplay(){const e=Math.floor(this.timer.elapsed/1e3),t=Math.floor(e/60),i=String(e%60).padStart(2,"0"),r=String(t).padStart(2,"0");this.timer.element.textContent=`${r}:${i}`}showVictoryModal(){this.pauseTimer(),document.getElementById("final-time").textContent=this.timer.element.textContent,document.getElementById("victory-modal").classList.add("active")}updateLevelNumber(e){if(!this.levelNumberElement&&(this.levelNumberElement=document.querySelector(".level-number"),!this.levelNumberElement)){console.error("No se pudo encontrar/crear el número de nivel");return}const t=Y.indexOf(e)+1;if(!t){console.warn("ID de nivel inválido:",e);return}requestAnimationFrame(()=>{this.levelNumberElement.textContent=`#${t}`,this.levelNumberElement.style.cssText=`
                display: block !important;
                visibility: visible !important;
                opacity: 1 !important;
            `})}resetControls(){this.selectionManager.resetControls()}};ve(me,"instance",null);let xe=me;const je=async()=>{var c;try{await new xe().initialize()}catch(e){console.error("Error:",e),(c=document.querySelector(".js-loading-overlay"))==null||c.remove(),document.body.classList.remove("js-loading")}};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",je):je();export{Se as I,Me as N,qe as W};
//# sourceMappingURL=main.js.map
